<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">ğŸ«€ GMR</div>
            <div class="nav-right">
                <span class="doctor-badge" id="doctorName">ğŸ‘¨â€âš•ï¸ Loading...</span>
                <a href="index.html" onclick="logout()" class="btn btn-secondary-small">Logout</a>
            </div>
        </div>
    </nav>

    <!-- Dashboard Content -->
    <section class="dashboard-section">
        <div class="dashboard-container">
            <h1>ğŸ‘¨â€âš•ï¸ Doctor Dashboard</h1>
            <p class="welcome-text">Welcome back! Select an action below:</p>

            <!-- Action Cards -->
            <div class="dashboard-grid">

                <!-- New Report Card -->
                <a href="/new-report.html" class="dashboard-card card-primary">
                    <div class="card-icon">ğŸ“</div>
                    <h3>New Report</h3>
                    <p>Generate a new cardiac assessment report</p>
                    <span class="card-arrow">â†’</span>
                </a>

                <!-- View Reports Card -->
                <a href="/report.html" class="dashboard-card card-secondary">
                    <div class="card-icon">ğŸ“š</div>
                    <h3>Reports History</h3>
                    <p>View previously generated reports</p>
                    <span class="card-arrow">â†’</span>
                </a>

            </div>


        </div>
    </section>

    <script>
        async function initDashboard() {
            try {
                const response = await fetch('http://localhost:8080/api/dashboard', {
                    credentials: 'include'
                });

                if (response.status === 403 || response.status === 401) {
                    window.location.href = '/login.html';
                    return;
                }

                const data = await response.json();
                console.log('Dashboard data:', data);

                if (data && data.doctorCode) {
                    document.getElementById('doctorName').textContent = `ğŸ‘¨â€âš•ï¸ Dr. ${data.doctorCode}`;
                }
            } catch (err) {
                console.error('Eroare:', err);
                window.location.href = '/login.html';
            }
        }

        // â† ADAUGÄ‚ FUNCÈšIA LOGOUT
        function logout() {
            localStorage.clear();
            window.location.href = '/login.html';
        }

        initDashboard();
    </script>


</body>
</html>